@model Utp.Models.Ubigeo

@{
    ViewBag.Title = "Index";
}

<h2>Index</h2>



<script src="~/Scripts/jquery-1.10.2.js" type="text/javascript"></script>
<script src="~/Scripts/jquery-1.10.2.min.js" type="text/javascript"></script>

<script type="text/javascript">
    $(document).ready(function () {
        //Dropdownlist Selectedchange event
        $("#Departamento").change(function () {
            $("#Provincia").empty();
   

            $.ajax({
                type: 'POST',
                url: '@Url.Action("GetStates")', // we are calling json method

                dataType: 'json',

                data: { idDepartamento: $("#Departamento").val() },
               // here we are get value of selected country and passing same value
                  //as inputto json method GetStates.

                success: function (states) {
                    // states contains the JSON formatted list
                    // of states passed from the controller
                                    
                    $("#Provincia").append('<option selected value="0">Seleccione</option>');
            
                    $("#Distrito").empty();
                    $("#Distrito").append('<option selected value="0">Seleccione</option>');

                    $.each(states, function (i, state) {
                        $("#Provincia").append('<option value="' + state.Value + '">' +
                         state.Text + '</option>');
                    // here we are adding option for States

                    });
                },
                error: function (ex) {
                    alert('Failed to retrieve states.' + ex);
                }
            });
            return false;
       
       
        })
    });
</script>

<script type="text/javascript">
    $(document).ready(function () {
        //Dropdownlist Selectedchange event
        $("#Provincia").change(function () {
            $("#Distrito").empty();
            debugger;
            $.ajax({
                type: 'POST',
                url: '@Url.Action("GetCity")',
                dataType: 'json',
                              
            data: {   idDepartamento: $("#Departamento").val(), idProvincia: $("#Provincia").val() },
                success: function (citys) {
                    // states contains the JSON formatted list
                    // of states passed from the controller


                    //$("#Distrito").empty();
                    $("#Distrito").append('<option selected value="0">Seleccione</option>');
                    $.each(citys, function (i, city) {
                        $("#Distrito").append('<option value="'
+ city.Value + '">'
+ city.Text + '</option>');
                    });
                },
                error: function (ex) {
                    alert('Failed to retrieve states.' + ex);
                }
            });
            return false;

           
        })
    });
</script> 


@using (Html.BeginForm())
{

<div class="editor-label">
    <br />
    <div style="color: Purple;">
        @Html.Label("Departamento")
    </div>

    <div class="editor-field">
     
       @Html.DropDownList("Departamento", ViewData["Ubigeo"] as List<SelectListItem>, "Seleccione Departamento")
    
    </div>



    <br />
    <div style="color: Purple;">
        @Html.Label("Provincia", new { style = "width:250px" })
    </div>
    <div class="editor-field">
        @Html.DropDownList("Provincia", new SelectList(string.Empty, "Value", "Text"), "Seleccione Distrito")
    </div>
    <br />

    <div style="color: Purple;">
        @Html.Label("Distrito", new { style = "width:250px" })
    </div>
    <div class="editor-field">
        @Html.DropDownList("Distrito", new SelectList(string.Empty, "Value", "Text"), "Seleccione Provincia")
    </div>
    <br />

    @*<input id="Submit1" type="submit" value="submit" />*@
</div>
}
